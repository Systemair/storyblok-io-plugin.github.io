(window.webpackJsonp=window.webpackJsonp||[]).push([[6,5],{339:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(152);var o=r(171),c=r(124);function l(e){return function(e){if(Array.isArray(e))return Object(n.a)(e)}(e)||Object(o.a)(e)||Object(c.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},343:function(e,t,r){"use strict";r.r(t);r(109),r(46),r(38),r(33),r(53),r(34),r(54);var n=r(23),o=r(6),c=(r(41),r(9),r(26),r(162),r(233),r(35),r(64),r(67));function l(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function f(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?l(Object(source),!0).forEach((function(t){Object(n.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):l(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var d={props:["value"],data:function(){return{contentFolders:[],search:"",breadcrumbs:[],loadingContentFolder:!1}},mounted:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loadingContentFolder=!0,e.$emit("input",{id:0,full_slug:""}),t.next=4,e.getContentFolder(0);case 4:e.contentFolders=t.sent,e.loadingContentFolder=!1;case 6:case"end":return t.stop()}}),t)})))()},computed:{contentFoldersFiltered:function(){var e=this;return this.contentFolders.filter((function(t){return t.label.toLowerCase().search(e.search)>-1}))}},methods:f(f({},Object(c.c)("storyblok",["components","searchStories"])),{},{onContentFolderSelected:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t.search="",t.breadcrumbs.push(e),r.next=4,t.syncBreadcrumbs();case 4:case"end":return r.stop()}}),r)})))()},onNavigate:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t.breadcrumbs=t.breadcrumbs.splice(0,e+1),r.next=3,t.syncBreadcrumbs();case 3:case"end":return r.stop()}}),r)})))()},onClearNavigation:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.breadcrumbs=[],t.next=3,e.syncBreadcrumbs();case 3:case"end":return t.stop()}}),t)})))()},getContentFolder:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",t.searchStories({with_parent:e,folder_only:1}).then((function(e){return e.map((function(e){return{label:e.name,value:{id:e.id,slug:e.slug},isParent:!0}}))})));case 1:case"end":return r.stop()}}),r)})))()},syncBreadcrumbs:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loadingContentFolder=!0,r=e.breadcrumbs[e.breadcrumbs.length-1],t.next=4,e.getContentFolder(r?r.value.id:0);case 4:e.contentFolders=t.sent,e.loadingContentFolder=!1,e.$emit("input",{id:r?r.value.id:0,full_slug:e.breadcrumbs.map((function(e){return e.value.slug})).join("/")});case 7:case"end":return t.stop()}}),t)})))()},filterContentFolder:function(e){this.search=e.value.toLowerCase(),console.log(this.search)}})},h=r(77),component=Object(h.a)(d,(function(){var e=this,t=e._self._c;return t("SbSelect",{attrs:{label:e.breadcrumbs.map((function(b){return b.label})).join("/")}},[t("SbMinibrowser",{staticStyle:{"background-color":"white"},attrs:{slot:"minibrowser",notFoundPrefix:"",options:e.contentFoldersFiltered,breadcrumbs:e.breadcrumbs,isExpanded:"",isLoading:e.loadingContentFolder},on:{filter:e.filterContentFolder,"select-item":e.onContentFolderSelected,navigate:e.onNavigate,"clear-navigation":e.onClearNavigation},slot:"minibrowser"})],1)}),[],!1,null,"1580b548",null);t.default=component.exports},345:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return w}));r(33),r(41),r(53),r(54),r(55),r(63),r(26),r(65),r(75);var n,o=r(23),c=r(6),l=r(17),f=r(18),d=(r(64),r(35),r(46),r(232),r(9),r(38),r(44),r(39),r(161),r(34),r(43),r(42),r(346),r(163),r(344)),h=r.n(d);function m(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return y(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return y(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return c=e.done,e},e:function(e){l=!0,o=e},f:function(){try{c||null==r.return||r.return()}finally{if(l)throw o}}}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}function v(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function k(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?v(Object(source),!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):v(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}!function(e){e.tab="tab",e.bloks="bloks",e.text="text",e.textarea="textarea",e.markdown="markdown",e.number="number",e.datetime="datetime",e.boolean="boolean",e.option="option",e.options="options",e.image="image",e.file="file",e.multiasset="multiasset",e.multilink="multilink",e.section="section",e.richtext="richtext",e._uid="uid",e.component="component",e.name="name"}(n||(n={}));var w=function(){function e(t){Object(l.a)(this,e),this.workbook=new h.a.Workbook,this.vuexStore=t}var t,r,o,d;return Object(f.a)(e,[{key:"spaceComponents",get:function(){return this.vuexStore.state.storyblok.components}},{key:"searchStories",value:(d=Object(c.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.vuexStore.dispatch("storyblok/searchStories",t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"readStory",value:(o=Object(c.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.vuexStore.dispatch("storyblok/readStory",t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"getWorksheetNames",value:function(){return this.workbook.worksheets.map((function(s){return s.name}))}},{key:"getWorksheetColumns",value:function(e){return this.workbook.getWorksheet(e).columns}},{key:"getRootContentTypeWorksheet",value:function(){return this.workbook.getWorksheet(1)}},{key:"getContentTypeSchema",value:function(e){var t;return(null===(t=this.spaceComponents.find((function(t){return t.name===e})))||void 0===t?void 0:t.schema)||{}}},{key:"asStory",value:function(e){var t=this.getRootContentTypeWorksheet().getRow(e),content=this.componentRowToObject(t);return k(k({},this.storyRowToObject(t)),{},{content:content})}},{key:"storyRowToObject",value:function(e){return{uuid:e.getCell("parent_id").text,parent_id:e.getCell("_SB_parent_id").text,name:e.getCell("_SB_name").text,slug:e.getCell("_SB_slug").text,full_slug:e.getCell("_SB_full_slug").text,is_startpage:e.getCell("_SB_is_startpage").text,updated_at:e.getCell("_SB_updated_at").text,published:e.getCell("_SB_published").text}}},{key:"componentRowToObject",value:function(e){for(var t=this.getContentTypeSchema(e.worksheet.name),r=function(e){return"_uid"===e?{type:n._uid}:"component"===e?{type:n.component}:t[e]},content={},o=0,c=Object.keys(t);o<c.length;o++){var l=c[o],f=r(l);if(f.type!==n.tab){var d=e.getCell(e.worksheet.getColumn(l).letter).text;switch(f.type){case n._uid:break;case n.option:var h=this.workbook.getWorksheet(f.filter_content_type||""),m=h.getColumn("parent_id").letter,y=h.getColumn("name").values.indexOf(d);content[l]=h.getCell("".concat(m,":").concat(y)).text;break;case n.options:content[l]=d.split(",").map((function(e){return e.trim()}));break;case n.bloks:break;default:try{content[l]=JSON.parse(d)}catch(e){content[l]=d}}}}return Object.assign(content,{component:e.worksheet.name})}},{key:"addDataValidations",value:function(e){var t,r=this,o=this.spaceComponents.find((function(t){return t.name===e.name})),c=m(e.columns);try{var l=function(){var e=t.value,c=function(e){if(void 0!==e)return"_uid"===e?{type:n._uid}:"component"===e?{type:n.component}:null==o?void 0:o.schema[e]}(e.key);if(void 0===c)return"continue";switch(c.type){case n.option:case n.options:var l=r.workbook.getWorksheet(c.filter_content_type||"");if(l){var f=l.getColumn("name").letter;e.eachCell((function(e,t){var r;if(t<=1)e.value={text:e.text,hyperlink:"#'".concat(l.name,"'!A1")};else{if(c.type===n.options)return;if(e.value){var o=0;l.getColumn("parent_id").eachCell((function(t,r){o||t.value!=e.value||(o=r)}));var d=o?l.getCell("".concat(f,":").concat(o)).value:void 0;d&&(e.value=d)}e.dataValidation={type:"list",allowBlank:!0,formulae:["'".concat(l.name,"'!$").concat(f,"$2:$").concat(f,"$").concat(null===(r=l.lastRow)||void 0===r?void 0:r.number)]}}}))}}};for(c.s();!(t=c.n()).done;)l()}catch(e){c.e(e)}finally{c.f()}}},{key:"fitWorksheetColumns",value:function(e){e.columns.forEach((function(e){var t=0;e.eachCell({includeEmpty:!1},(function(e){t=Math.max(t,e.value?e.value.toString().length:0)})),e.width=Math.max(10,t)}))}},{key:"save",value:(r=Object(c.a)(regeneratorRuntime.mark((function e(t){var r,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=m(this.workbook.worksheets);try{for(r.s();!(n=r.n()).done;)o=n.value,this.addDataValidations(o),this.fitWorksheetColumns(o)}catch(e){r.e(e)}finally{r.f()}return e.next=4,this.workbook.xlsx.writeBuffer().then((function(data){var e=window.document.createElement("a");return e.href=window.URL.createObjectURL(new Blob([data],{type:"application/octet-stream"})),e.download=null!=t?t:"Untiteled-".concat((new Date).toISOString(),".xlsx"),document.body.appendChild(e),e.click(),window.URL.revokeObjectURL(e.href),document.body.removeChild(e),!0})).catch((function(e){return console.error(e),!1}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"load",value:(t=Object(c.a)(regeneratorRuntime.mark((function e(t){var r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.workbook=new h.a.Workbook,e.next=3,new Promise((function(e,r){var n=new FileReader;n.onload=function(t){return e(n.result)},n.onerror=function(e){return r(e)},n.readAsArrayBuffer(t)})).then((function(data){return r.workbook.xlsx.load(data)})).then((function(){var e;if(r.workbook){var t,n=m(r.workbook.worksheets);try{for(n.s();!(t=n.n()).done;){var o,c=t.value,l=c.getRow(1),f=m(c.columns);try{for(f.s();!(o=f.n()).done;){var d=o.value;d.key=null===(e=l.findCell(d.number))||void 0===e?void 0:e.text}}catch(e){f.e(e)}finally{f.f()}}}catch(e){n.e(e)}finally{n.f()}}}));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}()},348:function(e,t,r){var content=r(361);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(108).default)("33f27805",content,!0,{sourceMap:!1})},360:function(e,t,r){"use strict";r(348)},361:function(e,t,r){var n=r(107)(!1);n.push([e.i,".header[data-v-52d4c694]{display:flex;flex-direction:row;align-items:center}.content[data-v-52d4c694]{display:flex;flex-direction:column;margin:8px}.back-button[data-v-52d4c694]:hover{background-color:rgba(0,0,0,.06275)}.back-button[data-v-52d4c694]:active{background-color:rgba(0,0,0,.12549)}",""]),e.exports=n},452:function(e,t,r){"use strict";r.r(t);r(38),r(33),r(41),r(53),r(34),r(54);var n=r(23),o=r(6),c=(r(232),r(9),r(35),r(39),r(64),r(67)),l=(r(68),r(55),r(43),r(63),r(26),r(75),r(339)),f=r(17),d=r(18),h=r(28),m=r(25),y=r(14),v=(r(42),r(44),r(65),r(109),r(46),r(344)),k=r.n(v),w=r(345);function x(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function _(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?x(Object(source),!0).forEach((function(t){Object(n.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):x(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function O(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return S(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return S(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return c=e.done,e},e:function(e){l=!0,o=e},f:function(){try{c||null==r.return||r.return()}finally{if(l)throw o}}}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Object(y.a)(e);if(t){var o=Object(y.a)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Object(m.a)(this,r)}}var C=function(e){Object(h.a)(x,e);var t,r,n,c,m,y,v=j(x);function x(e){var t;return Object(f.a)(this,x),(t=v.call(this,e)).workbook=new k.a.Workbook,t.workbook.creator="storyblok-io-plugin",t.workbook.created=new Date,t.workbook.modified=new Date,t}return Object(d.a)(x,[{key:"generateLayout",value:(y=Object(o.a)(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new Array).push({header:"_SB_parent_id",key:"_SB_parent_id",width:50,style:{font:{bold:!0}}}),r.push({header:"_SB_name",key:"_SB_name"}),r.push({header:"_SB_slug",key:"_SB_slug"}),r.push({header:"_SB_full_slug",key:"_SB_full_slug"}),r.push({header:"_SB_is_startpage",key:"_SB_is_startpage"}),r.push({header:"_SB_updated_at",key:"_SB_updated_at"}),r.push({header:"_SB_published",key:"_SB_published"}),e.next=10,this.createWorksheetFromComponent(t,!0,{tabColor:{argb:"FF0000FF"}},r);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return y.apply(this,arguments)})},{key:"exportStory",value:(m=Object(o.a)(regeneratorRuntime.mark((function e(t){var r,n,o,c=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=c.length>1&&void 0!==c[1]&&c[1],e.next=3,this.readStory(t);case 3:return n=e.sent,o=r?{_SB_parent_id:n.parent_id,_SB_name:n.name,_SB_slug:n.slug,_SB_full_slug:n.full_slug,_SB_is_startpage:n.is_startpage,_SB_updated_at:n.updated_at,_SB_published:n.published}:void 0,e.next=7,this.exportComponent(n.content,n.uuid,o);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"createWorksheetFromComponent",value:(c=Object(o.a)(regeneratorRuntime.mark((function e(component,t,r,n){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(o=this.workbook.getWorksheet(component.name))){e.next=3;break}return e.abrupt("return",{worksheet:o,created:!1});case 3:return o=this.workbook.addWorksheet(component.name,{views:[{state:"frozen",xSplit:2,ySplit:1}],properties:r}),e.next=6,this.createColumnsFromComponentFields(component,o,t,n);case 6:return e.abrupt("return",{worksheet:o,created:!0});case 7:case"end":return e.stop()}}),e,this)}))),function(e,t,r,n){return c.apply(this,arguments)})},{key:"createColumnsFromComponentFields",value:(n=Object(o.a)(regeneratorRuntime.mark((function e(component,t,r,n){var o,c,f,d,h,m,y,v,k,x,_,S,j,header,C=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(o=new Array).push({header:"_uid",key:"_uid",width:50,style:{font:{bold:!0}}}),o.push({header:"parent_id",key:"parent_id",width:50,style:{font:{bold:!0}}}),n&&o.push.apply(o,Object(l.a)(n)),c=0,f=Object.keys(component.schema);case 5:if(!(c<f.length)){e.next=60;break}if(d=f[c],(h=component.schema[d]).type!==w.a.tab){e.next=10;break}return e.abrupt("continue",57);case 10:m={header:d,key:d,_meta:h},e.t0=h.type,e.next=e.t0===w.a.option||e.t0===w.a.options?14:e.t0===w.a.bloks?18:56;break;case 14:if("internal_stories"!==h.source||!h.filter_content_type||!h.filter_content_type.length){e.next=17;break}return e.next=17,this.createOptionsSheet(h);case 17:return e.abrupt("break",56);case 18:if(r){e.next=20;break}return e.abrupt("break",56);case 20:if(!(y=h).component_whitelist){e.next=38;break}v=O(y.component_whitelist),e.prev=23,x=regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=k.value,!(r=C.spaceComponents.find((function(e){return e.name===t})))){e.next=5;break}return e.next=5,C.createWorksheetFromComponent(r,!1,!0);case 5:case"end":return e.stop()}}),e)})),v.s();case 26:if((k=v.n()).done){e.next=30;break}return e.delegateYield(x(),"t1",28);case 28:e.next=26;break;case 30:e.next=35;break;case 32:e.prev=32,e.t2=e.catch(23),v.e(e.t2);case 35:return e.prev=35,v.f(),e.finish(35);case 38:if(!y.component_group_whitelist){e.next=55;break}_=O(y.component_group_whitelist),e.prev=40,j=regeneratorRuntime.mark((function e(){var t,r,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=S.value,r=O(C.spaceComponents.filter((function(e){return e.component_group_uuid===t}))),e.prev=2,r.s();case 4:if((n=r.n()).done){e.next=10;break}return o=n.value,e.next=8,C.createWorksheetFromComponent(o,!1,!0);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[2,12,15,18]])})),_.s();case 43:if((S=_.n()).done){e.next=47;break}return e.delegateYield(j(),"t3",45);case 45:e.next=43;break;case 47:e.next=52;break;case 49:e.prev=49,e.t4=e.catch(40),_.e(e.t4);case 52:return e.prev=52,_.f(),e.finish(52);case 55:return e.abrupt("break",56);case 56:o.push(m);case 57:c++,e.next=5;break;case 60:t.columns=o,(header=t.getRow(1)).eachCell((function(e,t){var meta=o[t-1]._meta;if(meta){e.note=meta.description||"";var style={font:{}};meta.required&&(style.font=Object.assign(style.font,{color:{argb:"FFFF0000"}})),e.style=style}})),header.commit();case 64:case"end":return e.stop()}}),e,this,[[23,32,35,38],[40,49,52,55]])}))),function(e,t,r,o){return n.apply(this,arguments)})},{key:"createOptionsSheet",value:(r=Object(o.a)(regeneratorRuntime.mark((function e(t){var r,component,n,o,c,l,f,option;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.filter_content_type,component=this.spaceComponents.find((function(e){return e.name===r}))){e.next=5;break}return console.error("Unknown content type '".concat(r,"'. Abort creating options.")),e.abrupt("return",void 0);case 5:return e.next=7,this.createWorksheetFromComponent(component,!1,{tabColor:{argb:"FF00FFFF"}});case 7:if(n=e.sent,o=n.worksheet,!n.created){e.next=31;break}return e.next=13,this.searchStories({"filter_query[component][in]":r,story_only:1,with_summary:0});case 13:c=e.sent,l=O(c),e.prev=15,l.s();case 17:if((f=l.n()).done){e.next=23;break}return option=f.value,e.next=21,this.exportStory(option.id);case 21:e.next=17;break;case 23:e.next=28;break;case 25:e.prev=25,e.t0=e.catch(15),l.e(e.t0);case 28:return e.prev=28,l.f(),e.finish(28);case 31:return e.abrupt("return",o);case 32:case"end":return e.stop()}}),e,this,[[15,25,28,31]])}))),function(e){return r.apply(this,arguments)})},{key:"exportComponent",value:(t=Object(o.a)(regeneratorRuntime.mark((function e(component,t,r){var n,o,c,l,f,d,h,m,y,v,k,x,S,j;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=component.component,o=this.spaceComponents.find((function(e){return e.name===n})),c=function(e){return"_uid"===e?{type:w.a._uid}:"component"===e?{type:w.a.component}:null==o?void 0:o.schema[e]},l=this.workbook.getWorksheet(n)){e.next=7;break}return console.error("Unknown component '".concat(n,"' encountered.")),e.abrupt("return");case 7:f=_({parent_id:t},r),d=0,h=Object.keys(component);case 9:if(!(d<h.length)){e.next=52;break}if(m=h[d],!(y=c(m))){e.next=48;break}v=component[m],e.t0=y.type,e.next=e.t0===w.a._uid?17:e.t0===w.a.bloks?19:e.t0===w.a.datetime?39:e.t0===w.a.options?41:44;break;case 17:return f=Object.assign(f,{_uid:v}),e.abrupt("break",46);case 19:x=O(k=v),e.prev=21,x.s();case 23:if((S=x.n()).done){e.next=29;break}return j=S.value,e.next=27,this.exportComponent(j,component._uid);case 27:e.next=23;break;case 29:e.next=34;break;case 31:e.prev=31,e.t1=e.catch(21),x.e(e.t1);case 34:return e.prev=34,x.f(),e.finish(34);case 37:return f=Object.defineProperty(f,m,{value:k.map((function(e){return e._uid})).join(", ")}),e.abrupt("break",46);case 39:return f=Object.defineProperty(f,m,{value:v?new Date(v):void 0}),e.abrupt("break",46);case 41:if("internal_stories"!==y.source){e.next=44;break}return f=Object.defineProperty(f,m,{value:v.join(", ")}),e.abrupt("break",46);case 44:return f=Object.defineProperty(f,m,{value:v}),e.abrupt("break",46);case 46:e.next=49;break;case 48:console.warn("Found field '".concat(m,"' in component '").concat(n,"', but it is not defined in StoryBlok schema. Field will be ignored."),component);case 49:d++,e.next=9;break;case 52:l.addRow(f);case 53:case"end":return e.stop()}}),e,this,[[21,31,34,37]])}))),function(e,r,n){return t.apply(this,arguments)})}]),x}(w.b);function R(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function F(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?R(Object(source),!0).forEach((function(t){Object(n.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):R(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var P={data:function(){return{contentType:void 0,contentFolder:void 0,exporting:!1,exportProgressIndicatorType:"spinner",exportProgress:0,exportStatus:""}},mounted:function(){return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},computed:F({},Object(c.d)("storyblok",["components"])),methods:F(F({},Object(c.c)("storyblok",["searchStories","readStory"])),{},{exportData:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var r,n,o,c,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.exporting){t.next=2;break}return t.abrupt("return");case 2:return e.exporting=!0,e.exportProgress=0,e.exportStatus="",e.exportProgressIndicatorType="spinner",r=e.components.find((function(component){return component.name===e.contentType})),n=e.contentFolder.full_slug,o=new C(e.$store),e.exportStatus="Prepare Excel sheet layout for content type '".concat(e.contentType,"' ..."),t.next=12,o.generateLayout(r);case 12:return e.exportStatus="Retrieving all stories of content type '".concat(e.contentType,"' from root folder '").concat(n,"' ..."),t.next=15,e.searchStories({"filter_query[component][in]":e.contentType,starts_with:n,story_only:1});case 15:c=t.sent,e.exportProgressIndicatorType="bar",i=0;case 18:if(!(i<c.length)){t.next=26;break}return e.exportProgress=i/c.length*100,e.exportStatus="Exporting '".concat(c[i].full_slug,"' ..."),t.next=23,o.exportStory(c[i].id,!0);case 23:i++,t.next=18;break;case 26:return e.exportStatus="Saving Excel file ...",e.exportProgress=100,t.next=30,o.save("".concat(e.contentType,"-").concat((new Date).toISOString(),".xlsx"));case 30:e.exporting=!1;case 31:case"end":return t.stop()}}),t)})))()}})},B=(r(360),r(77)),D=Object(B.a)(P,(function(){var e=this,t=e._self._c;return t("div",[e.exporting?t("SbModal",{attrs:{isOpen:e.exporting,"full-width":"",escCloses:!1,closeOnHeader:!1},on:{hide:function(t){e.exporting=!1}}},[t("SbModalHeader",{attrs:{title:"Exporting data..."}}),e._v(" "),t("SbModalContent",[t("SbLoading",{staticStyle:{position:"absolute",left:"50%",transform:"translateX(-50%)"},attrs:{value:e.exportProgress,type:e.exportProgressIndicatorType,"show-percentage":"bar"===e.exportProgressIndicatorType}}),e._v(" "),t("p",{staticStyle:{"text-align":"center","margin-top":"48px"}},[e._v(e._s(e.exportStatus))])],1)],1):e._e(),e._v(" "),t("SbCard",[t("SbCardHeader",{staticClass:"header"},[t("SbIcon",{staticClass:"back-button",attrs:{size:"large",name:"chevron-back"},on:{click:function(t){return e.$router.go(-1)}}}),e._v(" "),t("h3",[e._v("Export Data")])],1),e._v(" "),t("SbCardContent",{staticClass:"content"},[t("SbFormItem",{attrs:{label:"Content Type","helper-icon-text":"Select a content type you want to export."}},[t("SbSelect",{staticStyle:{"max-width":"300px"},attrs:{options:e.components,label:"",itemLabel:"name",itemValue:"name",filterable:""},model:{value:e.contentType,callback:function(t){e.contentType=t},expression:"contentType"}})],1),e._v(" "),t("SbFormItem",{attrs:{label:"Content Folder","helper-icon-text":"Select a root content folder from where all stories with that content type will be export from."}},[t("ContentFolderSelector",{model:{value:e.contentFolder,callback:function(t){e.contentFolder=t},expression:"contentFolder"}})],1)],1),e._v(" "),t("SbCardFooter",[t("SbButton",{attrs:{label:"Export",isDisabled:!e.contentType},on:{click:e.exportData}})],1)],1)],1)}),[],!1,null,"52d4c694",null);t.default=D.exports;installComponents(D,{ContentFolderSelector:r(343).default})}}]);